# Path to Oh My Zsh
export ZSH="$HOME/.oh-my-zsh"

# Theme
ZSH_THEME="simple"

# Update Settings
zstyle ':omz:update' mode reminder
zstyle ':omz:update' frequency 13

# Plugins
plugins=(
  # Tools
  chezmoi
  dnf
  docker
  docker-compose
  git
  mise
  # Utils
  colored-man-pages
  extract
  fancy-ctrl-z
  history
  sudo
  z
  # Third-party plugins
  you-should-use
  zsh-autosuggestions
  zsh-bat
  zsh-syntax-highlighting  # Must be last
)

source $ZSH/oh-my-zsh.sh

# --- User Configuration ---

# Preferred Editor
export EDITOR="nvim"
export VISUAL="nvim"

# Language Environment
export LANG=en_US.UTF-8

# History Optimization
HISTSIZE=10000
SAVEHIST=10000
setopt APPEND_HISTORY
setopt INC_APPEND_HISTORY
setopt SHARE_HISTORY
setopt HIST_IGNORE_DUPS
setopt HIST_IGNORE_ALL_DUPS
setopt HIST_IGNORE_SPACE

# WinApps / Libvirt Support
export LIBVIRT_DEFAULT_URI="qemu:///system"

# Ensure local bin is in PATH
export PATH="$HOME/.local/bin:$PATH"

# Aliases
alias zshrc="nvim ~/.zshrc"
alias lg="lazygit"
alias cz="check-bw-session && chezmoi"

# Functions
check-bw-session() {
  if [ -z "$BW_SESSION" ]; then
    echo "ðŸ”’ Unlocking Bitwarden..."
    export BW_SESSION=$(bw unlock --raw)
  fi
}

# --- Tool Initialization ---

# Mise (Dev Tools Manager)
if command -v mise &> /dev/null; then
  eval "$(mise activate zsh)"
fi
